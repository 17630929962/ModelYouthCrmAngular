{"version":3,"file":"simplemde.umd.min.js","sources":["../../__gen_lib/src/config.ts","../../__gen_lib/src/component.ts","../../__gen_lib/src/module.ts"],"sourcesContent":["export class SimplemdeConfig {\r\n  /**\r\n   * 风格，默认：`antd`\r\n   */\r\n  style?: 'default' | 'antd' = 'antd';\r\n  /**\r\n   * 延迟初始化\r\n   */\r\n  delay?: number;\r\n  /** 全局 `options` */\r\n  options?: { [key: string]: any };\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  forwardRef,\r\n  ElementRef,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  Output,\r\n  OnInit,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  AfterViewInit,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  NgZone,\r\n  ViewChild,\r\n  SimpleChange,\r\n} from '@angular/core';\r\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\r\n\r\nimport { SimplemdeConfig } from './config';\r\n\r\ndeclare const SimpleMDE: any;\r\n\r\n@Component({\r\n  selector: 'simplemde',\r\n  template: `<textarea #con></textarea>`,\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => SimplemdeComponent),\r\n      multi: true,\r\n    },\r\n  ],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SimplemdeComponent\r\n  implements AfterViewInit, OnChanges, OnDestroy, ControlValueAccessor {\r\n  @ViewChild('con') private con: ElementRef;\r\n  private instance: any;\r\n  private value: string;\r\n\r\n  private onChange: (value: string) => void;\r\n  private onTouched: () => void;\r\n\r\n  @Input() options: any;\r\n  /** 风格，默认：`antd` */\r\n  @Input() style: 'default' | 'antd';\r\n  /** 延迟初始化 */\r\n  @Input() delay: number;\r\n\r\n  constructor(\r\n    private cog: SimplemdeConfig,\r\n    private cd: ChangeDetectorRef,\r\n    private zone: NgZone,\r\n  ) {\r\n    this.style = cog.style;\r\n    this.delay = cog.delay || 0;\r\n  }\r\n\r\n  private initDelay() {\r\n    if (this.delay > 0) {\r\n      setTimeout(() => this.init(), this.delay);\r\n    } else {\r\n      this.init();\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    if (typeof SimpleMDE === 'undefined') {\r\n      throw new Error(`Could not find SimpleMDE object.`);\r\n    }\r\n    this.destroy();\r\n    const config = Object.assign(\r\n      {},\r\n      this.cog,\r\n      this.options,\r\n      this.style === 'antd'\r\n        ? {\r\n            spellChecker: false,\r\n            autoDownloadFontAwesome: false,\r\n          }\r\n        : {},\r\n    );\r\n    config.element = this.con.nativeElement;\r\n    this.zone.runOutsideAngular(() => {\r\n      this.instance = new SimpleMDE(config);\r\n      if (this.value) {\r\n        this.instance.value(this.value);\r\n      }\r\n      this.instance.codemirror.on('change', () => {\r\n        this.value = this.instance.value();\r\n        this.zone.run(() => this.onChange(this.value));\r\n      });\r\n    });\r\n  }\r\n\r\n  private destroy() {\r\n    if (this.instance) {\r\n      this.instance.toTextArea();\r\n      this.instance = null;\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.initDelay();\r\n  }\r\n\r\n  ngOnChanges(\r\n    changes: { [P in keyof this]?: SimpleChange } & SimpleChanges,\r\n  ): void {\r\n    if (!changes.options.firstChange) this.initDelay();\r\n  }\r\n\r\n  /**\r\n   * 获取UE实例\r\n   *\r\n   * @readonly\r\n   */\r\n  get Instance(): any {\r\n    return this.instance;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.destroy();\r\n  }\r\n\r\n  // reuse-tab: http://ng-alain.com/components/reuse-tab#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\r\n  _onReuseInit() {\r\n    this.initDelay();\r\n  }\r\n\r\n  writeValue(value: string): void {\r\n    this.value = value;\r\n    if (this.instance) {\r\n      this.instance.value(this.value);\r\n    }\r\n  }\r\n\r\n  registerOnChange(fn: (_: any) => {}): void {\r\n    this.onChange = fn;\r\n  }\r\n  registerOnTouched(fn: () => {}): void {\r\n    this.onTouched = fn;\r\n  }\r\n\r\n  setDisabledState(isDisabled: boolean): void {}\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule, ModuleWithProviders } from '@angular/core';\r\n\r\nimport { SimplemdeComponent } from './component';\r\nimport { SimplemdeConfig } from './config';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  declarations: [SimplemdeComponent],\r\n  exports: [SimplemdeComponent],\r\n})\r\nexport class SimplemdeModule {\r\n  static forRoot(config?: SimplemdeConfig): ModuleWithProviders {\r\n    return {\r\n      ngModule: SimplemdeModule,\r\n      providers: [{ provide: SimplemdeConfig, useValue: config }],\r\n    };\r\n  }\r\n}\r\n"],"names":["SimplemdeConfig","cog","cd","zone","this","style","delay","SimplemdeComponent","setTimeout","_this","init","SimpleMDE","Error","destroy","config","Object","assign","options","spellChecker","autoDownloadFontAwesome","element","con","nativeElement","runOutsideAngular","instance","value","codemirror","on","run","onChange","toTextArea","initDelay","changes","firstChange","fn","onTouched","isDisabled","Component","selector","template","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","changeDetection","ChangeDetectionStrategy","OnPush","ChangeDetectorRef","NgZone","ViewChild","Input","SimplemdeModule","ngModule","useValue","NgModule","imports","CommonModule","declarations","exports"],"mappings":"uWAAA,IAAAA,wBAI+B,qBC+C7B,WACUC,EACAC,EACAC,GAFAC,SAAAH,EACAG,QAAAF,EACAE,UAAAD,EAERC,KAAKC,MAAQJ,EAAII,MACjBD,KAAKE,MAAQL,EAAIK,OAAS,SAGpBC,4CACW,EAAbH,KAAKE,MACPE,WAAW,WAAM,OAAAC,EAAKC,QAAQN,KAAKE,OAEnCF,KAAKM,QAIDH,uCACN,GAAyB,oBAAdI,UACT,MAAM,IAAIC,MAAM,oCAElBR,KAAKS,UACL,IAAMC,EAASC,OAAOC,OACpB,GACAZ,KAAKH,IACLG,KAAKa,QACU,SAAfb,KAAKC,MACD,CACEa,cAAc,EACdC,yBAAyB,GAE3B,IAENL,EAAOM,QAAUhB,KAAKiB,IAAIC,cAC1BlB,KAAKD,KAAKoB,kBAAkB,WAC1Bd,EAAKe,SAAW,IAAIb,UAAUG,GAC1BL,EAAKgB,OACPhB,EAAKe,SAASC,MAAMhB,EAAKgB,OAE3BhB,EAAKe,SAASE,WAAWC,GAAG,SAAU,WACpClB,EAAKgB,MAAQhB,EAAKe,SAASC,QAC3BhB,EAAKN,KAAKyB,IAAI,WAAM,OAAAnB,EAAKoB,SAASpB,EAAKgB,cAKrClB,+BACFH,KAAKoB,WACPpB,KAAKoB,SAASM,aACd1B,KAAKoB,SAAW,OAIpBjB,4BAAA,WACEH,KAAK2B,aAGPxB,wBAAA,SACEyB,GAEKA,EAAQf,QAAQgB,aAAa7B,KAAK2B,aAQzChB,sBAAIR,4BAAJ,WACE,OAAOH,KAAKoB,0CAGdjB,wBAAA,WACEH,KAAKS,WAIPN,yBAAA,WACEH,KAAK2B,aAGPxB,uBAAA,SAAWkB,GACTrB,KAAKqB,MAAQA,EACTrB,KAAKoB,UACPpB,KAAKoB,SAASC,MAAMrB,KAAKqB,QAI7BlB,6BAAA,SAAiB2B,GACf9B,KAAKyB,SAAWK,GAElB3B,8BAAA,SAAkB2B,GAChB9B,KAAK+B,UAAYD,GAGnB3B,6BAAA,SAAiB6B,yBA1HlBC,kBAAU,CACTC,SAAU,YACVC,SAAU,6BACVC,UAAW,CACT,CACEC,QAASC,oBACTC,YAAaC,aAAW,WAAM,OAAArC,IAC9BsC,OAAO,IAGXC,gBAAiBC,0BAAwBC,oDAdlChD,SAVPiD,2BAIAC,yCAwBCC,kBAAU,wBAOVC,uBAEAA,uBAEAA,kDCrCMC,UAAP,SAAevC,GACb,MAAO,CACLwC,SAAUD,EACVb,UAAW,CAAC,CAAEC,QAASzC,EAAiBuD,SAAUzC,0BATvD0C,iBAAS,CACRC,QAAS,CAACC,gBACVC,aAAc,CAACpD,GACfqD,QAAS,CAACrD"}